p8105\_hw2\_wq2160
================
Wenshan Qu (wq2160)
10/8/2021

## Problem 1

Read and clean the Mr. Trash Wheel data set.

``` r
trash_wheel = 
  read_excel("./data_1/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = 1, range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  drop_na(month) %>% 
  mutate(
    sports_balls = as.integer(round(sports_balls))
  )

trash_wheel
```

    ## # A tibble: 453 × 14
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##    <chr>    <chr> <dbl> <dttm>                    <dbl>              <dbl>
    ##  1 1        May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2 2        May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3 3        May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4 4        May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5 5        May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6 6        May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7 7        May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8 8        May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9 9        June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10 10       June   2014 2014-06-11 00:00:00        3.76                 18
    ## # … with 443 more rows, and 8 more variables: plastic_bottles <dbl>,
    ## #   polystyrene <dbl>, cigarette_butts <dbl>, glass_bottles <dbl>,
    ## #   grocery_bags <dbl>, chip_bags <dbl>, sports_balls <int>,
    ## #   homes_powered <dbl>

Read and clean the precipitation data for 2018.

``` r
pre_18 = 
  read_excel("./data_1/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "2018 Precipitation", skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(
    year = c("2018")
  )

pre_18
```

    ## # A tibble: 12 × 3
    ##    month total year 
    ##    <dbl> <dbl> <chr>
    ##  1     1  0.94 2018 
    ##  2     2  4.8  2018 
    ##  3     3  2.69 2018 
    ##  4     4  4.69 2018 
    ##  5     5  9.27 2018 
    ##  6     6  4.77 2018 
    ##  7     7 10.2  2018 
    ##  8     8  6.45 2018 
    ##  9     9 10.5  2018 
    ## 10    10  2.12 2018 
    ## 11    11  7.82 2018 
    ## 12    12  6.11 2018

Read and clean the precipitation data for 2019.

``` r
pre_19 = 
  read_excel("./data_1/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "2019 Precipitation", skip = 1) %>% 
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(
    year = c("2019")
  )

pre_19
```

    ## # A tibble: 12 × 3
    ##    month total year 
    ##    <dbl> <dbl> <chr>
    ##  1     1  3.1  2019 
    ##  2     2  3.64 2019 
    ##  3     3  4.47 2019 
    ##  4     4  1.46 2019 
    ##  5     5  3.58 2019 
    ##  6     6  0.42 2019 
    ##  7     7  3.85 2019 
    ##  8     8  2.39 2019 
    ##  9     9  0.16 2019 
    ## 10    10  5.45 2019 
    ## 11    11  1.86 2019 
    ## 12    12  3.57 2019

Combine precipitation data sets of 2018 and 2019.

``` r
pre_1819 = 
  left_join(pre_18, pre_19, by = "month") %>% 
  mutate(
    month = month.name[month]
  ) %>% 
  relocate(month, year.x, total.x, year.y, total.y)

pre_1819
```

    ## # A tibble: 12 × 5
    ##    month     year.x total.x year.y total.y
    ##    <chr>     <chr>    <dbl> <chr>    <dbl>
    ##  1 January   2018      0.94 2019      3.1 
    ##  2 February  2018      4.8  2019      3.64
    ##  3 March     2018      2.69 2019      4.47
    ##  4 April     2018      4.69 2019      1.46
    ##  5 May       2018      9.27 2019      3.58
    ##  6 June      2018      4.77 2019      0.42
    ##  7 July      2018     10.2  2019      3.85
    ##  8 August    2018      6.45 2019      2.39
    ##  9 September 2018     10.5  2019      0.16
    ## 10 October   2018      2.12 2019      5.45
    ## 11 November  2018      7.82 2019      1.86
    ## 12 December  2018      6.11 2019      3.57

The **number of observation** in trash wheel dataset is
`nrow(trash_wheel)`; in 2018 Precipitation is `nrow(pre_18)`, and in
2019 Precipitation is `nrow(pre_19)`, in combination set of 2018 and
2019 precipitation is `nrow(pre_1819)`.

The **key variables** in trash wheel is `names(trash_wheel)`, in 2018
Precipitation is `names(pre_18)`, in 2019 Precipitation is
`names(pre_19)`, and in combination set of 2018 and 2019 precipitation
is `names(pre_1819)`.

The **total precipitation** in 2018 is `sum(pull(pre_18, total))`, in
2019 is `sum(pull(pre_19, total))`. And the information get from
`pre_1819` is that the precipitation amount in 2019 is much lower than
2018, and this trend is extremely obvious during summer time (from April
to September).

The **median number of sports balls** in a dumpster in 2019 is
`filter(trash_wheel, year == "2019") %>% pull(sports_balls) %>% median()`.

## Problem 2

Clean and modify the pols-month data set.

``` r
pols_df = 
  read.csv("./data_2/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day)
  ) %>% 
  mutate(
    month = month.name[month] ## replace month number with month name 
  ) %>% 
  select(- day) %>% 
  relocate(year, month, prez_gop, prez_dem) %>% 
  mutate(
    prez_gop = na_if(prez_gop, 0),
    prez_dem = na_if(prez_dem, 0)  ## convert value "0" to NA for future manipulation
  ) %>% 
  pivot_longer(
    prez_gop:prez_dem,
    names_to = "name", 
    names_prefix = "prez_",
    values_to = "president"
  ) %>% 
  drop_na() %>% ## only remain one row (whether dem or gop) for each month of year
  select(- president) %>% ## clean the 0 and 1 value because it's meaningless, only reserve the "dem" or "gop" value
  rename(president = name) %>% ## rename the column containing what we need as president
  select(year, month, president, everything())

pols_df
```

    ## # A tibble: 822 × 9
    ##     year month     president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem
    ##    <int> <chr>     <chr>       <int>   <int>   <int>   <int>   <int>   <int>
    ##  1  1947 January   dem            23      51     253      23      45     198
    ##  2  1947 February  dem            23      51     253      23      45     198
    ##  3  1947 March     dem            23      51     253      23      45     198
    ##  4  1947 April     dem            23      51     253      23      45     198
    ##  5  1947 May       dem            23      51     253      23      45     198
    ##  6  1947 June      dem            23      51     253      23      45     198
    ##  7  1947 July      dem            23      51     253      23      45     198
    ##  8  1947 August    dem            23      51     253      23      45     198
    ##  9  1947 September dem            23      51     253      23      45     198
    ## 10  1947 October   dem            23      51     253      23      45     198
    ## # … with 812 more rows

Clean and modify snp data set.

``` r
library(lubridate) ## we use lubridate package to extract the date information
```

``` r
snp_df = 
  read.csv("./data_2/snp.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    month = month(mdy(date)),
    year = year(mdy(date)), ## use lubridate functions to extract month and year
    year = ifelse(year >= 2050, year - 100, year) ## lubridate will recognize two-digit old years (i.e. 50 ~ 68) as 2050 ~2068 instead of 1950 ~ 1968, so we manually correct it.
  ) %>% 
  select(year, month, close) %>% 
  mutate(
    month = month.name[month]
  ) %>% 
  arrange(year, month)

snp_df
```

    ##     year     month   close
    ## 1   1950     April   17.96
    ## 2   1950    August   18.42
    ## 3   1950  December   20.43
    ## 4   1950  February   17.22
    ## 5   1950   January   17.05
    ## 6   1950      July   17.84
    ## 7   1950      June   17.69
    ## 8   1950     March   17.29
    ## 9   1950       May   18.78
    ## 10  1950  November   19.51
    ## 11  1950   October   19.53
    ## 12  1950 September   19.45
    ## 13  1951     April   22.43
    ## 14  1951    August   23.28
    ## 15  1951  December   23.77
    ## 16  1951  February   21.80
    ## 17  1951   January   21.66
    ## 18  1951      July   22.40
    ## 19  1951      June   20.96
    ## 20  1951     March   21.48
    ## 21  1951       May   21.52
    ## 22  1951  November   22.88
    ## 23  1951   October   22.94
    ## 24  1951 September   23.26
    ## 25  1952     April   23.32
    ## 26  1952    August   25.03
    ## 27  1952  December   26.57
    ## 28  1952  February   23.26
    ## 29  1952   January   24.14
    ## 30  1952      July   25.40
    ## 31  1952      June   24.96
    ## 32  1952     March   24.37
    ## 33  1952       May   23.86
    ## 34  1952  November   25.66
    ## 35  1952   October   24.52
    ## 36  1952 September   24.54
    ## 37  1953     April   24.62
    ## 38  1953    August   23.32
    ## 39  1953  December   24.81
    ## 40  1953  February   25.90
    ## 41  1953   January   26.38
    ## 42  1953      July   24.75
    ## 43  1953      June   24.14
    ## 44  1953     March   25.29
    ## 45  1953       May   24.54
    ## 46  1953  November   24.76
    ## 47  1953   October   24.54
    ## 48  1953 September   23.35
    ## 49  1954     April   28.26
    ## 50  1954    August   29.83
    ## 51  1954  December   35.98
    ## 52  1954  February   26.15
    ## 53  1954   January   26.08
    ## 54  1954      July   30.88
    ## 55  1954      June   29.21
    ## 56  1954     March   26.94
    ## 57  1954       May   29.19
    ## 58  1954  November   34.24
    ## 59  1954   October   31.68
    ## 60  1954 September   32.31
    ## 61  1955     April   37.96
    ## 62  1955    August   43.18
    ## 63  1955  December   45.48
    ## 64  1955  February   36.76
    ## 65  1955   January   36.63
    ## 66  1955      July   43.52
    ## 67  1955      June   41.03
    ## 68  1955     March   36.58
    ## 69  1955       May   37.91
    ## 70  1955  November   45.51
    ## 71  1955   October   42.34
    ## 72  1955 September   43.67
    ## 73  1956     April   48.38
    ## 74  1956    August   47.51
    ## 75  1956  December   46.67
    ## 76  1956  February   45.34
    ## 77  1956   January   43.82
    ## 78  1956      July   49.39
    ## 79  1956      June   46.97
    ## 80  1956     March   48.48
    ## 81  1956       May   45.20
    ## 82  1956  November   45.08
    ## 83  1956   October   45.58
    ## 84  1956 September   45.35
    ## 85  1957     April   45.74
    ## 86  1957    August   45.22
    ## 87  1957  December   39.99
    ## 88  1957  February   43.26
    ## 89  1957   January   44.72
    ## 90  1957      July   47.91
    ## 91  1957      June   47.37
    ## 92  1957     March   44.11
    ## 93  1957       May   47.43
    ## 94  1957  November   41.72
    ## 95  1957   October   41.06
    ## 96  1957 September   42.42
    ## 97  1958     April   43.44
    ## 98  1958    August   47.75
    ## 99  1958  December   55.21
    ## 100 1958  February   40.84
    ## 101 1958   January   41.70
    ## 102 1958      July   47.19
    ## 103 1958      June   45.24
    ## 104 1958     March   42.10
    ## 105 1958       May   44.09
    ## 106 1958  November   52.48
    ## 107 1958   October   51.33
    ## 108 1958 September   50.06
    ## 109 1959     April   57.59
    ## 110 1959    August   59.60
    ## 111 1959  December   59.89
    ## 112 1959  February   55.41
    ## 113 1959   January   55.45
    ## 114 1959      July   60.51
    ## 115 1959      June   58.47
    ## 116 1959     March   55.44
    ## 117 1959       May   58.68
    ## 118 1959  November   58.28
    ## 119 1959   October   57.52
    ## 120 1959 September   56.88
    ## 121 1960     April   54.37
    ## 122 1960    August   56.96
    ## 123 1960  December   58.11
    ## 124 1960  February   56.12
    ## 125 1960   January   55.61
    ## 126 1960      July   55.51
    ## 127 1960      June   56.92
    ## 128 1960     March   55.34
    ## 129 1960       May   55.83
    ## 130 1960  November   55.54
    ## 131 1960   October   53.39
    ## 132 1960 September   53.52
    ## 133 1961     April   65.31
    ## 134 1961    August   68.07
    ## 135 1961  December   71.55
    ## 136 1961  February   63.44
    ## 137 1961   January   61.78
    ## 138 1961      July   66.76
    ## 139 1961      June   64.64
    ## 140 1961     March   65.06
    ## 141 1961       May   66.56
    ## 142 1961  November   71.32
    ## 143 1961   October   68.62
    ## 144 1961 September   66.73
    ## 145 1962     April   65.24
    ## 146 1962    August   59.12
    ## 147 1962  December   63.10
    ## 148 1962  February   69.96
    ## 149 1962   January   68.84
    ## 150 1962      July   58.23
    ## 151 1962      June   54.75
    ## 152 1962     March   69.55
    ## 153 1962       May   59.63
    ## 154 1962  November   62.26
    ## 155 1962   October   56.52
    ## 156 1962 September   56.27
    ## 157 1963     April   69.80
    ## 158 1963    August   72.50
    ## 159 1963  December   75.02
    ## 160 1963  February   64.29
    ## 161 1963   January   66.20
    ## 162 1963      July   69.13
    ## 163 1963      June   69.37
    ## 164 1963     March   66.57
    ## 165 1963       May   70.80
    ## 166 1963  November   73.23
    ## 167 1963   October   74.01
    ## 168 1963 September   71.70
    ## 169 1964     April   79.46
    ## 170 1964    August   81.83
    ## 171 1964  December   84.75
    ## 172 1964  February   77.80
    ## 173 1964   January   77.04
    ## 174 1964      July   83.18
    ## 175 1964      June   81.69
    ## 176 1964     March   78.98
    ## 177 1964       May   80.37
    ## 178 1964  November   84.42
    ## 179 1964   October   84.86
    ## 180 1964 September   84.18
    ## 181 1965     April   89.11
    ## 182 1965    August   87.17
    ## 183 1965  December   92.43
    ## 184 1965  February   87.43
    ## 185 1965   January   87.56
    ## 186 1965      July   85.25
    ## 187 1965      June   84.12
    ## 188 1965     March   86.16
    ## 189 1965       May   88.42
    ## 190 1965  November   91.61
    ## 191 1965   October   92.42
    ## 192 1965 September   89.96
    ## 193 1966     April   91.06
    ## 194 1966    August   77.10
    ## 195 1966  December   80.33
    ## 196 1966  February   91.22
    ## 197 1966   January   92.88
    ## 198 1966      July   83.60
    ## 199 1966      June   84.74
    ## 200 1966     March   89.23
    ## 201 1966       May   86.13
    ## 202 1966  November   80.45
    ## 203 1966   October   80.20
    ## 204 1966 September   76.56
    ## 205 1967     April   94.01
    ## 206 1967    August   93.64
    ## 207 1967  December   96.47
    ## 208 1967  February   86.78
    ## 209 1967   January   86.61
    ## 210 1967      July   94.75
    ## 211 1967      June   90.64
    ## 212 1967     March   90.20
    ## 213 1967       May   89.08
    ## 214 1967  November   94.00
    ## 215 1967   October   93.30
    ## 216 1967 September   96.71
    ## 217 1968     April   97.46
    ## 218 1968    August   98.86
    ## 219 1968  December  103.86
    ## 220 1968  February   89.36
    ## 221 1968   January   92.24
    ## 222 1968      July   97.74
    ## 223 1968      June   99.58
    ## 224 1968     March   90.20
    ## 225 1968       May   98.68
    ## 226 1968  November  108.37
    ## 227 1968   October  103.41
    ## 228 1968 September  102.67
    ## 229 1969     April  103.69
    ## 230 1969    August   95.51
    ## 231 1969  December   92.06
    ## 232 1969  February   98.13
    ## 233 1969   January  103.01
    ## 234 1969      July   91.83
    ## 235 1969      June   97.71
    ## 236 1969     March  101.51
    ## 237 1969       May  103.46
    ## 238 1969  November   93.81
    ## 239 1969   October   97.12
    ## 240 1969 September   93.12
    ## 241 1970     April   81.52
    ## 242 1970    August   81.52
    ## 243 1970  December   92.15
    ## 244 1970  February   89.50
    ## 245 1970   January   85.02
    ## 246 1970      July   78.05
    ## 247 1970      June   72.72
    ## 248 1970     March   89.63
    ## 249 1970       May   76.55
    ## 250 1970  November   87.20
    ## 251 1970   October   83.25
    ## 252 1970 September   84.30
    ## 253 1971     April  103.95
    ## 254 1971    August   99.03
    ## 255 1971  December  102.09
    ## 256 1971  February   96.75
    ## 257 1971   January   95.88
    ## 258 1971      July   95.58
    ## 259 1971      June   98.70
    ## 260 1971     March  100.31
    ## 261 1971       May   99.63
    ## 262 1971  November   93.99
    ## 263 1971   October   94.23
    ## 264 1971 September   98.34
    ## 265 1972     April  107.67
    ## 266 1972    August  111.09
    ## 267 1972  December  118.05
    ## 268 1972  February  106.57
    ## 269 1972   January  103.94
    ## 270 1972      July  107.39
    ## 271 1972      June  107.14
    ## 272 1972     March  107.20
    ## 273 1972       May  109.53
    ## 274 1972  November  116.67
    ## 275 1972   October  111.58
    ## 276 1972 September  110.55
    ## 277 1973     April  106.97
    ## 278 1973    August  104.25
    ## 279 1973  December   97.55
    ## 280 1973  February  111.68
    ## 281 1973   January  116.03
    ## 282 1973      July  108.22
    ## 283 1973      June  104.26
    ## 284 1973     March  111.52
    ## 285 1973       May  104.95
    ## 286 1973  November   95.96
    ## 287 1973   October  108.29
    ## 288 1973 September  108.43
    ## 289 1974     April   90.31
    ## 290 1974    August   72.15
    ## 291 1974  December   68.56
    ## 292 1974  February   96.22
    ## 293 1974   January   96.57
    ## 294 1974      July   79.31
    ## 295 1974      June   86.00
    ## 296 1974     March   93.98
    ## 297 1974       May   87.28
    ## 298 1974  November   69.97
    ## 299 1974   October   73.90
    ## 300 1974 September   63.54
    ## 301 1975     April   87.30
    ## 302 1975    August   86.88
    ## 303 1975  December   90.19
    ## 304 1975  February   81.59
    ## 305 1975   January   76.98
    ## 306 1975      July   88.75
    ## 307 1975      June   95.19
    ## 308 1975     March   83.36
    ## 309 1975       May   91.15
    ## 310 1975  November   91.24
    ## 311 1975   October   89.04
    ## 312 1975 September   83.87
    ## 313 1976     April  101.64
    ## 314 1976    August  102.91
    ## 315 1976  December  107.46
    ## 316 1976  February   99.71
    ## 317 1976   January  100.86
    ## 318 1976      July  103.44
    ## 319 1976      June  104.28
    ## 320 1976     March  102.77
    ## 321 1976       May  100.18
    ## 322 1976  November  102.10
    ## 323 1976   October  102.90
    ## 324 1976 September  105.24
    ## 325 1977     April   98.44
    ## 326 1977    August   96.77
    ## 327 1977  December   95.10
    ## 328 1977  February   99.82
    ## 329 1977   January  102.03
    ## 330 1977      July   98.85
    ## 331 1977      June  100.48
    ## 332 1977     March   98.42
    ## 333 1977       May   96.12
    ## 334 1977  November   94.83
    ## 335 1977   October   92.34
    ## 336 1977 September   96.53
    ## 337 1978     April   96.83
    ## 338 1978    August  103.29
    ## 339 1978  December   96.11
    ## 340 1978  February   87.04
    ## 341 1978   January   89.25
    ## 342 1978      July  100.68
    ## 343 1978      June   95.53
    ## 344 1978     March   89.21
    ## 345 1978       May   97.24
    ## 346 1978  November   94.70
    ## 347 1978   October   93.15
    ## 348 1978 September  102.54
    ## 349 1979     April  101.76
    ## 350 1979    August  109.32
    ## 351 1979  December  107.94
    ## 352 1979  February   96.28
    ## 353 1979   January   99.93
    ## 354 1979      July  103.81
    ## 355 1979      June  102.91
    ## 356 1979     March  101.59
    ## 357 1979       May   99.08
    ## 358 1979  November  106.16
    ## 359 1979   October  101.82
    ## 360 1979 September  109.32
    ## 361 1980     April  106.29
    ## 362 1980    August  122.38
    ## 363 1980  December  135.76
    ## 364 1980  February  113.66
    ## 365 1980   January  114.16
    ## 366 1980      July  121.67
    ## 367 1980      June  114.24
    ## 368 1980     March  102.09
    ## 369 1980       May  111.24
    ## 370 1980  November  140.52
    ## 371 1980   October  127.47
    ## 372 1980 September  125.46
    ## 373 1981     April  132.81
    ## 374 1981    August  122.79
    ## 375 1981  December  122.55
    ## 376 1981  February  131.27
    ## 377 1981   January  129.55
    ## 378 1981      July  130.92
    ## 379 1981      June  131.21
    ## 380 1981     March  136.00
    ## 381 1981       May  132.59
    ## 382 1981  November  126.35
    ## 383 1981   October  121.89
    ## 384 1981 September  116.18
    ## 385 1982     April  116.44
    ## 386 1982    August  119.51
    ## 387 1982  December  140.64
    ## 388 1982  February  113.11
    ## 389 1982   January  120.40
    ## 390 1982      July  107.09
    ## 391 1982      June  109.61
    ## 392 1982     March  111.96
    ## 393 1982       May  111.88
    ## 394 1982  November  138.53
    ## 395 1982   October  133.72
    ## 396 1982 September  120.42
    ## 397 1983     April  164.43
    ## 398 1983    August  164.40
    ## 399 1983  December  164.93
    ## 400 1983  February  148.06
    ## 401 1983   January  145.30
    ## 402 1983      July  162.56
    ## 403 1983      June  167.64
    ## 404 1983     March  152.96
    ## 405 1983       May  162.39
    ## 406 1983  November  166.40
    ## 407 1983   October  163.55
    ## 408 1983 September  166.07
    ## 409 1984     April  160.05
    ## 410 1984    August  166.68
    ## 411 1984  December  167.24
    ## 412 1984  February  157.06
    ## 413 1984   January  163.41
    ## 414 1984      July  150.66
    ## 415 1984      June  153.18
    ## 416 1984     March  159.18
    ## 417 1984       May  150.55
    ## 418 1984  November  163.58
    ## 419 1984   October  166.09
    ## 420 1984 September  166.10
    ## 421 1985     April  179.83
    ## 422 1985    August  188.63
    ## 423 1985  December  211.28
    ## 424 1985  February  181.18
    ## 425 1985   January  179.63
    ## 426 1985      July  190.92
    ## 427 1985      June  191.85
    ## 428 1985     March  180.66
    ## 429 1985       May  189.55
    ## 430 1985  November  202.17
    ## 431 1985   October  189.82
    ## 432 1985 September  182.08
    ## 433 1986     April  235.52
    ## 434 1986    August  252.93
    ## 435 1986  December  242.17
    ## 436 1986  February  226.92
    ## 437 1986   January  211.78
    ## 438 1986      July  236.12
    ## 439 1986      June  250.84
    ## 440 1986     March  238.90
    ## 441 1986       May  247.35
    ## 442 1986  November  249.22
    ## 443 1986   October  243.98
    ## 444 1986 September  231.32
    ## 445 1987     April  288.36
    ## 446 1987    August  329.80
    ## 447 1987  December  247.08
    ## 448 1987  February  284.20
    ## 449 1987   January  274.08
    ## 450 1987      July  318.66
    ## 451 1987      June  304.00
    ## 452 1987     March  291.70
    ## 453 1987       May  290.10
    ## 454 1987  November  230.30
    ## 455 1987   October  251.79
    ## 456 1987 September  321.83
    ## 457 1988     April  261.33
    ## 458 1988    August  261.52
    ## 459 1988  December  277.72
    ## 460 1988  February  267.82
    ## 461 1988   January  257.07
    ## 462 1988      July  272.02
    ## 463 1988      June  273.50
    ## 464 1988     March  258.89
    ## 465 1988       May  262.16
    ## 466 1988  November  273.70
    ## 467 1988   October  278.97
    ## 468 1988 September  271.91
    ## 469 1989     April  309.64
    ## 470 1989    August  351.45
    ## 471 1989  December  353.40
    ## 472 1989  February  288.86
    ## 473 1989   January  297.47
    ## 474 1989      July  346.08
    ## 475 1989      June  317.98
    ## 476 1989     March  294.87
    ## 477 1989       May  320.52
    ## 478 1989  November  345.99
    ## 479 1989   October  340.36
    ## 480 1989 September  349.15
    ## 481 1990     April  330.80
    ## 482 1990    August  322.56
    ## 483 1990  December  330.22
    ## 484 1990  February  331.89
    ## 485 1990   January  329.08
    ## 486 1990      July  356.15
    ## 487 1990      June  358.02
    ## 488 1990     March  339.94
    ## 489 1990       May  361.23
    ## 490 1990  November  322.22
    ## 491 1990   October  304.00
    ## 492 1990 September  306.05
    ## 493 1991     April  375.34
    ## 494 1991    August  395.43
    ## 495 1991  December  417.09
    ## 496 1991  February  367.07
    ## 497 1991   January  343.93
    ## 498 1991      July  387.81
    ## 499 1991      June  371.16
    ## 500 1991     March  375.22
    ## 501 1991       May  389.83
    ## 502 1991  November  375.22
    ## 503 1991   October  392.45
    ## 504 1991 September  387.86
    ## 505 1992     April  414.95
    ## 506 1992    August  414.03
    ## 507 1992  December  435.71
    ## 508 1992  February  412.70
    ## 509 1992   January  408.78
    ## 510 1992      July  424.21
    ## 511 1992      June  408.14
    ## 512 1992     March  403.69
    ## 513 1992       May  415.35
    ## 514 1992  November  431.35
    ## 515 1992   October  418.68
    ## 516 1992 September  417.80
    ## 517 1993     April  440.19
    ## 518 1993    August  463.56
    ## 519 1993  December  466.45
    ## 520 1993  February  443.38
    ## 521 1993   January  438.78
    ## 522 1993      July  448.13
    ## 523 1993      June  450.53
    ## 524 1993     March  451.67
    ## 525 1993       May  450.19
    ## 526 1993  November  461.79
    ## 527 1993   October  467.83
    ## 528 1993 September  458.93
    ## 529 1994     April  450.91
    ## 530 1994    August  475.49
    ## 531 1994  December  459.27
    ## 532 1994  February  467.14
    ## 533 1994   January  481.61
    ## 534 1994      July  458.26
    ## 535 1994      June  444.27
    ## 536 1994     March  445.77
    ## 537 1994       May  456.50
    ## 538 1994  November  453.69
    ## 539 1994   October  472.35
    ## 540 1994 September  462.71
    ## 541 1995     April  514.71
    ## 542 1995    August  561.88
    ## 543 1995  December  615.93
    ## 544 1995  February  487.39
    ## 545 1995   January  470.42
    ## 546 1995      July  562.06
    ## 547 1995      June  544.75
    ## 548 1995     March  500.71
    ## 549 1995       May  533.40
    ## 550 1995  November  605.37
    ## 551 1995   October  581.50
    ## 552 1995 September  584.41
    ## 553 1996     April  654.17
    ## 554 1996    August  651.99
    ## 555 1996  December  740.74
    ## 556 1996  February  640.43
    ## 557 1996   January  636.02
    ## 558 1996      July  639.95
    ## 559 1996      June  670.63
    ## 560 1996     March  645.50
    ## 561 1996       May  669.12
    ## 562 1996  November  757.02
    ## 563 1996   October  705.27
    ## 564 1996 September  687.33
    ## 565 1997     April  801.34
    ## 566 1997    August  899.47
    ## 567 1997  December  970.43
    ## 568 1997  February  790.82
    ## 569 1997   January  786.16
    ## 570 1997      July  954.31
    ## 571 1997      June  885.14
    ## 572 1997     March  757.12
    ## 573 1997       May  848.28
    ## 574 1997  November  955.40
    ## 575 1997   October  914.62
    ## 576 1997 September  947.28
    ## 577 1998     April 1111.75
    ## 578 1998    August  957.28
    ## 579 1998  December 1229.23
    ## 580 1998  February 1049.34
    ## 581 1998   January  980.28
    ## 582 1998      July 1120.67
    ## 583 1998      June 1133.84
    ## 584 1998     March 1101.75
    ## 585 1998       May 1090.82
    ## 586 1998  November 1163.63
    ## 587 1998   October 1098.67
    ## 588 1998 September 1017.01
    ## 589 1999     April 1335.18
    ## 590 1999    August 1320.41
    ## 591 1999  December 1469.25
    ## 592 1999  February 1238.33
    ## 593 1999   January 1279.64
    ## 594 1999      July 1328.72
    ## 595 1999      June 1372.71
    ## 596 1999     March 1286.37
    ## 597 1999       May 1301.84
    ## 598 1999  November 1388.91
    ## 599 1999   October 1362.93
    ## 600 1999 September 1282.71
    ## 601 2000     April 1452.43
    ## 602 2000    August 1517.68
    ## 603 2000  December 1320.28
    ## 604 2000  February 1366.42
    ## 605 2000   January 1394.46
    ## 606 2000      July 1430.83
    ## 607 2000      June 1454.60
    ## 608 2000     March 1498.58
    ## 609 2000       May 1420.60
    ## 610 2000  November 1314.95
    ## 611 2000   October 1429.40
    ## 612 2000 September 1436.51
    ## 613 2001     April 1249.46
    ## 614 2001    August 1133.58
    ## 615 2001  December 1148.08
    ## 616 2001  February 1239.94
    ## 617 2001   January 1366.01
    ## 618 2001      July 1211.23
    ## 619 2001      June 1224.38
    ## 620 2001     March 1160.33
    ## 621 2001       May 1255.82
    ## 622 2001  November 1139.45
    ## 623 2001   October 1059.78
    ## 624 2001 September 1040.94
    ## 625 2002     April 1076.92
    ## 626 2002    August  916.07
    ## 627 2002  December  879.82
    ## 628 2002  February 1106.73
    ## 629 2002   January 1130.20
    ## 630 2002      July  911.62
    ## 631 2002      June  989.82
    ## 632 2002     March 1147.39
    ## 633 2002       May 1067.14
    ## 634 2002  November  936.31
    ## 635 2002   October  885.76
    ## 636 2002 September  815.28
    ## 637 2003     April  916.92
    ## 638 2003    August 1008.01
    ## 639 2003  December 1111.92
    ## 640 2003  February  841.15
    ## 641 2003   January  855.70
    ## 642 2003      July  990.31
    ## 643 2003      June  974.50
    ## 644 2003     March  848.18
    ## 645 2003       May  963.59
    ## 646 2003  November 1058.20
    ## 647 2003   October 1050.71
    ## 648 2003 September  995.97
    ## 649 2004     April 1107.30
    ## 650 2004    August 1104.24
    ## 651 2004  December 1211.92
    ## 652 2004  February 1144.94
    ## 653 2004   January 1131.13
    ## 654 2004      July 1101.72
    ## 655 2004      June 1140.84
    ## 656 2004     March 1126.21
    ## 657 2004       May 1120.68
    ## 658 2004  November 1173.82
    ## 659 2004   October 1130.20
    ## 660 2004 September 1114.58
    ## 661 2005     April 1156.85
    ## 662 2005    August 1220.33
    ## 663 2005  December 1248.29
    ## 664 2005  February 1203.60
    ## 665 2005   January 1181.27
    ## 666 2005      July 1234.18
    ## 667 2005      June 1191.33
    ## 668 2005     March 1180.59
    ## 669 2005       May 1191.50
    ## 670 2005  November 1249.48
    ## 671 2005   October 1207.01
    ## 672 2005 September 1228.81
    ## 673 2006     April 1310.61
    ## 674 2006    August 1303.82
    ## 675 2006  December 1418.30
    ## 676 2006  February 1280.66
    ## 677 2006   January 1280.08
    ## 678 2006      July 1276.66
    ## 679 2006      June 1270.20
    ## 680 2006     March 1294.87
    ## 681 2006       May 1270.09
    ## 682 2006  November 1400.63
    ## 683 2006   October 1377.94
    ## 684 2006 September 1335.85
    ## 685 2007     April 1482.37
    ## 686 2007    August 1473.99
    ## 687 2007  December 1468.36
    ## 688 2007  February 1406.82
    ## 689 2007   January 1438.24
    ## 690 2007      July 1455.27
    ## 691 2007      June 1503.35
    ## 692 2007     March 1420.86
    ## 693 2007       May 1530.62
    ## 694 2007  November 1481.14
    ## 695 2007   October 1549.38
    ## 696 2007 September 1526.75
    ## 697 2008     April 1385.59
    ## 698 2008    August 1282.83
    ## 699 2008  December  903.25
    ## 700 2008  February 1330.63
    ## 701 2008   January 1378.55
    ## 702 2008      July 1267.38
    ## 703 2008      June 1280.00
    ## 704 2008     March 1322.70
    ## 705 2008       May 1400.38
    ## 706 2008  November  896.24
    ## 707 2008   October  968.75
    ## 708 2008 September 1166.36
    ## 709 2009     April  872.81
    ## 710 2009    August 1020.62
    ## 711 2009  December 1115.10
    ## 712 2009  February  735.09
    ## 713 2009   January  825.88
    ## 714 2009      July  987.48
    ## 715 2009      June  919.32
    ## 716 2009     March  797.87
    ## 717 2009       May  919.14
    ## 718 2009  November 1095.63
    ## 719 2009   October 1036.19
    ## 720 2009 September 1057.08
    ## 721 2010     April 1186.69
    ## 722 2010    August 1049.33
    ## 723 2010  December 1257.64
    ## 724 2010  February 1104.49
    ## 725 2010   January 1073.87
    ## 726 2010      July 1101.60
    ## 727 2010      June 1030.71
    ## 728 2010     March 1169.43
    ## 729 2010       May 1089.41
    ## 730 2010  November 1180.55
    ## 731 2010   October 1183.26
    ## 732 2010 September 1141.20
    ## 733 2011     April 1363.61
    ## 734 2011    August 1218.89
    ## 735 2011  December 1257.60
    ## 736 2011  February 1327.22
    ## 737 2011   January 1286.12
    ## 738 2011      July 1292.28
    ## 739 2011      June 1320.64
    ## 740 2011     March 1325.83
    ## 741 2011       May 1345.20
    ## 742 2011  November 1246.96
    ## 743 2011   October 1253.30
    ## 744 2011 September 1131.42
    ## 745 2012     April 1397.91
    ## 746 2012    August 1406.58
    ## 747 2012  December 1426.19
    ## 748 2012  February 1365.68
    ## 749 2012   January 1312.41
    ## 750 2012      July 1379.32
    ## 751 2012      June 1362.16
    ## 752 2012     March 1408.47
    ## 753 2012       May 1310.33
    ## 754 2012  November 1416.18
    ## 755 2012   October 1412.16
    ## 756 2012 September 1440.67
    ## 757 2013     April 1597.57
    ## 758 2013    August 1632.97
    ## 759 2013  December 1848.36
    ## 760 2013  February 1514.68
    ## 761 2013   January 1498.11
    ## 762 2013      July 1685.73
    ## 763 2013      June 1606.28
    ## 764 2013     March 1569.19
    ## 765 2013       May 1630.74
    ## 766 2013  November 1805.81
    ## 767 2013   October 1756.54
    ## 768 2013 September 1681.55
    ## 769 2014     April 1883.95
    ## 770 2014    August 2003.37
    ## 771 2014  December 2058.90
    ## 772 2014  February 1859.45
    ## 773 2014   January 1782.59
    ## 774 2014      July 1930.67
    ## 775 2014      June 1960.23
    ## 776 2014     March 1872.34
    ## 777 2014       May 1923.57
    ## 778 2014  November 2067.56
    ## 779 2014   October 2018.05
    ## 780 2014 September 1972.29
    ## 781 2015     April 2085.51
    ## 782 2015  February 2104.50
    ## 783 2015   January 1994.99
    ## 784 2015      July 2079.65
    ## 785 2015      June 2063.11
    ## 786 2015     March 2067.89
    ## 787 2015       May 2107.39

Clean and modify unemployment data.

``` r
unemployment_df = 
  read.csv("./data_2/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment"
  ) %>% 
  mutate(
    month = recode(month, "jan" = 1, "feb" = 2, "mar" = 3, "apr" = 4, "may" = 5, "jun" = 6, "jul" = 7, "aug" = 8, "sep" = 9, "oct" = 10, "nov" = 11, "dec" = 12),
    month = month.name[month]
  )

unemployment_df
```

    ## # A tibble: 816 × 3
    ##     year month     unemployment
    ##    <int> <chr>            <dbl>
    ##  1  1948 January            3.4
    ##  2  1948 February           3.8
    ##  3  1948 March              4  
    ##  4  1948 April              3.9
    ##  5  1948 May                3.5
    ##  6  1948 June               3.6
    ##  7  1948 July               3.6
    ##  8  1948 August             3.9
    ##  9  1948 September          3.8
    ## 10  1948 October            3.7
    ## # … with 806 more rows

Join the datasets.

``` r
pols_snp = 
  left_join(pols_df, snp_df, by = c("year", "month"))
pols_snp_unemploy = 
  left_join(pols_snp, unemployment_df, by = c("year", "month")) %>% 
  arrange(year, month)

pols_snp_unemploy
```

    ## # A tibble: 822 × 11
    ##     year month   president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem close
    ##    <dbl> <chr>   <chr>       <int>   <int>   <int>   <int>   <int>   <int> <dbl>
    ##  1  1947 April   dem            23      51     253      23      45     198    NA
    ##  2  1947 August  dem            23      51     253      23      45     198    NA
    ##  3  1947 Decemb… dem            24      51     253      23      45     198    NA
    ##  4  1947 Februa… dem            23      51     253      23      45     198    NA
    ##  5  1947 January dem            23      51     253      23      45     198    NA
    ##  6  1947 July    dem            23      51     253      23      45     198    NA
    ##  7  1947 June    dem            23      51     253      23      45     198    NA
    ##  8  1947 March   dem            23      51     253      23      45     198    NA
    ##  9  1947 May     dem            23      51     253      23      45     198    NA
    ## 10  1947 Novemb… dem            24      51     253      23      45     198    NA
    ## # … with 812 more rows, and 1 more variable: unemployment <dbl>

``` r
head(pols_snp_unemploy)
```

    ## # A tibble: 6 × 11
    ##    year month    president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem close
    ##   <dbl> <chr>    <chr>       <int>   <int>   <int>   <int>   <int>   <int> <dbl>
    ## 1  1947 April    dem            23      51     253      23      45     198    NA
    ## 2  1947 August   dem            23      51     253      23      45     198    NA
    ## 3  1947 December dem            24      51     253      23      45     198    NA
    ## 4  1947 February dem            23      51     253      23      45     198    NA
    ## 5  1947 January  dem            23      51     253      23      45     198    NA
    ## 6  1947 July     dem            23      51     253      23      45     198    NA
    ## # … with 1 more variable: unemployment <dbl>

``` r
tail(pols_snp_unemploy)
```

    ## # A tibble: 6 × 11
    ##    year month    president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem close
    ##   <dbl> <chr>    <chr>       <int>   <int>   <int>   <int>   <int>   <int> <dbl>
    ## 1  2015 April    dem            31      54     244      18      44     188 2086.
    ## 2  2015 February dem            31      54     245      18      44     188 2104.
    ## 3  2015 January  dem            31      54     245      18      44     188 1995.
    ## 4  2015 June     dem            31      54     246      18      44     188 2063.
    ## 5  2015 March    dem            31      54     245      18      44     188 2068.
    ## 6  2015 May      dem            31      54     245      18      44     188 2107.
    ## # … with 1 more variable: unemployment <dbl>

**pols-month** data set contains the number of national politicians who
are democratic or republican at any given time, such as at a given month
and year, whether the president belongs to democratic or republican
party, and the number of republican or democratic governors, senators
and representatives.

**snp** data set presents Standard & Poor’s stock market index, which
shows the closing values of the S&P stock index on the associated date.

**unemployment** data set contains the percentage of unemployment at a
given month and year.

**The resulting data set** contains 822 rows and 11 columns, and the
year range is from 1947 to 2015, and the names of key variables could be
seen by `names(pols_snp_unemploy)`, which contains “year”, “month”,
“president”, “gov\_gop”, “sen\_gop”, “rep\_gop”, “gov\_dem”, “sen\_dem”,
“rep\_dem”, “close” and “unemployment”. Note that the `unemployment`
data set range from 1948 to 2015, and the `snp` range from 1950 to 2015.

## Problem 3

Load and tidy the data.

``` r
bbname_df = 
  read.csv("./data_3/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  rename(childs_first_name = child_s_first_name) %>% 
  mutate(
    ethnicity = str_to_lower(ethnicity),
    childs_first_name = str_to_title(childs_first_name), ## change names to "Abcde" format
    year_of_birth = as.integer(year_of_birth),
    gender = str_to_lower(gender),
    gender = as.factor(gender),
    ethnicity = recode(ethnicity,
                       "asian and pacific islander" = "asian and paci",
                       "black non hispanic" = "black non hisp",
                       "white non hispanic" = "white non hisp")
  ) %>% 
  distinct()
```
